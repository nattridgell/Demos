<link rel="import" href="bower_components/polymer/polymer.html">
<link rel="import" href="bower_components/google-apis/google-apis.html">
<link rel="import" href="bower_components/google-map/google-map.html">

<!--
<polymer-element name="google-map-highlighter-marker" extends="google-map-marker" attributes="placeId icon">
<template>
<shadow></shadow>
</template>
<script>
( function() {
    Polymer({
      placeId: null,
      title: null,
      mapReady: function() {
        this.updateLocation();
        this.super();
      },

    });
})();

</script>
</polymer-element>

<polymer-element name="google-map-highlighter-map" extends="google-map" attributes="apiKey latitude longitude zoom showCenterMarker version map mapType disableDefaultUI fitToMarkers zoomable styles maxZoom minZoom libraries">
<template>
  <shadow></shadow>
  <content id="markers" select="google-map-highlighter-marker"></content>
</template>
<script>
    Polymer({
         mapApiLoaded: function() {
           window.console.log("I am in mapApiLoaded.");
           this.super(); 
         }

    });

</script>
</polymer-element> -->






<polymer-element name="google-map-highlighter" attributes="apiKey map name placeId latitude longitude phone">
<template>

  <style>
    :host {
      position: relative;
      display: block;
      height: 100%;
    }

    google-map {
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
    }

  </style>
 <!-- TODO: put content inside -->

 <!-- <google-maps-api apiKey="{{apiKey}}" version='3.exp' on-api-load="{{updateLocation}}" libraries="places"></google-maps-api> -->

  <google-map map="{{map}}" zoom="14" on-google-map-ready="{{mapReady}}" fitToMarkers latitude="[[latitude]]" longitude="[[longitude]]">
     <google-map-marker id="marker" latitude="{{latitude}}" longitude="{{longitude}}" title="{{name}}"></google-map-marker></google-map>

</template>
<script>
Polymer({
    /**
     * A latitude to put the marker on and centre, calculated if an address is given.
     *
     * @attribute latitude
     * @type number
     * @default 37.77493
     */
    latitude: 37.77493,

    /**
     * A longitude to put the marker on and centre, calculated if an address is given.
     *
     * @attribute longitude
     * @type number
     * @default -122.41942
     */
    longitude: -122.41942,

    /**
     * Name of the place being highlighted.
     *
     * @attribute phoneNumber
     * @type string
     * @default The Sydney Opera House
     */
    contact: "0118 999 881 999 119 725 3",

    /**
     * Name of the place being highlighted.
     *
     * @attribute name
     * @type string
     * @default The Sydney Opera House
     */
    name: "The Sydney Opera House",

    /**
     * If set, removes the map's default UI controls.
     *
     * @attribute disableDefaultUI
     * @type boolean
     * @default false
     */
    disableDefaultUI: false,

    apiKey: null,
    content: null,
    map: null,
    marker:null,

    mapReady:  function() {
      this.updateLocation();
	var marker = document.getElementsByName("google-map-marker");
      this.contentChanged();
    },

      updateLocation: function() {
        window.console.log("I am in updateLocation.");
        if (this.placeId) {
          window.console.log("I am inside if this.placeId.");
          var service = new google.maps.places.PlacesService(this.map);
          service.getDetails({placeId: this.placeId}, function(place, status) {
          window.console.log("Check service status.");
            if (status == google.maps.places.PlacesServiceStatus.OK) {
              this.latitude = place.geometry.location.lat();
              this.longitude = place.geometry.location.lng();
              this.title = place.name; // TODO: Check the syntax for title and icon declaration
              window.console.log("Lat: "+ this.latitude+" Lng: "+this.longitude+ " Name: "+this.title);
            }
          });
        }
      },

    contentChanged: function(){
	var marker = this.$.marker;
	marker.innerHTML = this.innerHTML;
}
    
  });

</script>
</polymer-element>
